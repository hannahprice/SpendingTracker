@using SpendingTracker.Shared.Models;
@page "/budgets/add"

<MudGrid Justify="Justify.Center" Spacing="5">
    <MudItem xs="12" sm="10">
        <MudPaper Class="pa-16 ma-16" Elevation="3">
            <MudText Typo="Typo.h5" Class="mb-7">Add new budget</MudText>
            <MudForm @ref="Form">
                <MudNumericField @bind-Value="@Budget.Amount"
                              Label="Amount"
                              Min="1.0m"
                              Required="true"
                              RequiredError="Amount is required"
                              Adornment="Adornment.Start"
                              AdornmentIcon="@Icons.Filled.CurrencyPound" />

                <MudSelect @bind-Value="@Budget.Frequency"
                           T="Frequency"
                           Label="Frequency"
                           Required="true"
                           RequiredError="Frequency is required"
                           AnchorOrigin="Origin.BottomCenter">
                    @foreach (Frequency item in Enum.GetValues(typeof(Frequency)))
                    {
                        <MudSelectItem Value="@item">@item</MudSelectItem>
                    }
                </MudSelect>

                <MudText Typo="Typo.caption">Categories</MudText>
                <MudChipSet @bind-SelectedChips="@SelectedCategories"
                            MultiSelection="true"
                            Filter="true">
                    @foreach (Category category in AvailableCategories)
                    {
                        <MudChip Text="@category?.Description"></MudChip>
                    }
                </MudChipSet>

                <MudText Typo="Typo.caption">Subcategories</MudText>
                <MudChipSet @bind-SelectedChips="@SelectedSubcategories"
                            MultiSelection="true"
                            Filter="true">
                    @foreach (Subcategory category in AvailableSubcategories)
                    {
                        <MudChip Text="@category?.Description"></MudChip>
                    }
                </MudChipSet>

                <MudButton Variant="Variant.Filled"
                           Color="Color.Primary"
                           Class="ml-auto"
                           OnClick="@(async ()=> await Submit())">
                    Submit
                </MudButton>
            </MudForm>
        </MudPaper>
    </MudItem>
    @if (Success != null && Success.Value)
    {
        <MudItem xs="12" sm="10">
            <MudAlert Severity="Severity.Success" Variant="Variant.Outlined">Budget added</MudAlert>
        </MudItem>
    }
    else if (Success != null && !Success.Value)
    {
        <MudItem xs="12" sm="10">
            <MudAlert Severity="Severity.Error" Variant="Variant.Outlined">Failed to add budget</MudAlert>
        </MudItem>
    }
</MudGrid>